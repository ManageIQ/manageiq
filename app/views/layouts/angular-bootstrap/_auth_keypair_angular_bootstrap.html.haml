- ng_show                   ||= true
- validate_url              ||= 'create'
- prefix                    ||= 'ssh_keypair'
- userid_label              ||= _("Username")
- private_key_label         ||= _("Private Key")
- new_private_key_label     ||= _("New ") + private_key_label
- ng_reqd_userid            ||= false
- ng_reqd_private_key       ||= false
- userid_disabled           ||= false
- private_key_disabled      ||= false
- change_stored_private_key ||= _("Change stored private key")
- cancel_private_key_change ||= _("Cancel private key change")
- verify_title_off          ||= _("Server information, username and private key fields are needed to perform verification of credentials")

%div{"ng-controller" => "emsKeypairController"}
  %div{"ng-show" => "#{ng_show}"}
    .form-group{"ng-class" => "{'has-error': angularForm.#{prefix}_userid.$error.required}"}
      %label.col-md-2.control-label{"for" => "textInput-markup"}
        = userid_label
      .col-md-4
        %input.form-control{"type"                => "text",
                            "id"                  => "textInput-markup",
                            "ng-required"         => "#{ng_reqd_userid}",
                            "ng-disabled"         => userid_disabled,
                            "name"                => "#{prefix}_userid",
                            "ng-model"            => "#{ng_model}.#{prefix}_userid",
                            "checkchange"         => ""}
        %span.help-block{"ng-show" => "angularForm.#{prefix}_userid.$error.required"}
          = _("Required")
        .note
          {{note}}

  %div{"ng-show" => "#{ng_show}"}
    .form-group{"ng-class" => "{'has-error': angularForm.#{prefix}_password.$error.required}"}
      %label.col-md-2.control-label{"for" => "textInput-markup"}
        %div{"ng-show" => "bChangeStoredPrivateKey != true"}
          = private_key_label
        %div{"ng-show" => "bChangeStoredPrivateKey"}
          = new_private_key_label
      .col-md-4
        %input.form-control{"type"                  => "file",
                            "id"                    => "textInput-markup",
                            "ng-required"           => "#{ng_reqd_private_key}",
                            "ng-disabled"           => "!showVerifyPrivateKey('#{prefix}_userid')" || private_key_disabled,
                            "name"                  => "#{prefix}_password_dummy",
                            "ng-model"              => "#{ng_model}.#{prefix}_password",
                            "prefix"                => "#{prefix}",
                            "checkchange"           => "",
                            "require-file"          => ""}
        %input{:type => 'text', :id => "textInput-markup", :name => "#{prefix}_password", "ng-model" => "#{ng_model}.#{prefix}_password", :style => "display: none"}
        %span.help-block{"ng-show" => "angularForm.#{prefix}_password.$error.required"}
          = _("Required")
      %div{"ng-if" => "showChangePrivateKeyLinks('#{prefix}_userid')"}
        %a{:href => "", "ng-hide" => "bChangeStoredPrivateKey", "ng-click" => "changeStoredPrivateKey()"}
          = change_stored_private_key
        %a{:href => "", "ng-show" => "bChangeStoredPrivateKey", "ng-click" => "cancelPrivateKeyChange()"}
          = cancel_private_key_change

    %div{"ng-show" => "!showVerifyPrivateKey('#{prefix}_userid')"}
      .form-group
        %label.col-md-2
        .col-md-4
          = render :partial => "layouts/angular/form_buttons_verify_angular",
                                       :locals  => {:ng_show          => "#{ng_show}",
                                                    :validate_url     => validate_url,
                                                    :id               => id,
                                                    :valtype          => "#{prefix}",
                                                    :verify_title_off => verify_title_off,
                                                    :basic_info_needed => defined?(basic_info_needed) ? basic_info_needed : nil}

    %div{"ng-show" => "showVerifyPrivateKey('#{prefix}_userid')"}
      .form-group
        %label.col-md-2
        .col-md-4
          = render :partial => "layouts/angular/form_buttons_verify_angular",
                                       :locals  => {:ng_show          => "#{ng_show}",
                                                    :validate_url     => validate_url,
                                                    :id               => id,
                                                    :valtype          => "#{prefix}",
                                                    :verify_title_off => verify_title_off,
                                                    :basic_info_needed => defined?(basic_info_needed) ? basic_info_needed : nil}
